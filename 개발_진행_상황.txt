================================================================================
Lightweight CI/CD - ê°œë°œ ì§„í–‰ ìƒí™©
================================================================================
ìµœì¢… ì—…ë°ì´íŠ¸: 2026-01-08

================================================================================
âœ… ì™„ë£Œëœ ì‘ì—…
================================================================================

Phase 1: Agent ê¸°ë³¸ êµ¬ì¡° (ì™„ë£Œ)
----------------------------------
âœ… Rust í”„ë¡œì íŠ¸ êµ¬ì¡° ì„¤ì • (Cargo.toml, Dockerfile)
âœ… SQLite ë°ì´í„°ë² ì´ìŠ¤ ì—°ë™ (sqlx 0.8)
âœ… ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ë° ë§ˆì´ê·¸ë ˆì´ì…˜
   - projects, builds í…Œì´ë¸”
   - Slot enum (Blue/Green)
   - BuildStatus enum (Queued, Building, Deploying, Success, Failed)
âœ… ì´ë²¤íŠ¸ ë²„ìŠ¤ ì‹œìŠ¤í…œ (tokio broadcast channel)
âœ… AppState (ê³µìœ  ìƒíƒœ ê´€ë¦¬)
âœ… Docker API ì—°ë™ (bollard 0.19)
âœ… ë¡œê¹… ì„¤ì • (tracing)

Phase 2: ë¹Œë“œ ì‹œìŠ¤í…œ (ì™„ë£Œ)
----------------------------------
âœ… Docker ë¹Œë“œ ì»¨í…Œì´ë„ˆ ì‹¤í–‰
   - agent/src/docker/client.rs - Docker API ë˜í¼
   - ë¹Œë“œ ì´ë¯¸ì§€ì—ì„œ ì»¨í…Œì´ë„ˆ ìƒì„± ë° ì‹¤í–‰
   - ë¡œê·¸ ìˆ˜ì§‘ (stdout/stderr)

âœ… ë¹Œë“œ ì‹¤í–‰ê¸° (agent/src/build/executor.rs)
   - Git clone/pull (workspace ê´€ë¦¬)
   - ë¹Œë“œ ì»¨í…Œì´ë„ˆ ì‹¤í–‰
   - ë¡œê·¸ íŒŒì¼ ì €ì¥ (/data/logs/)
   - ì´ë²¤íŠ¸ ë°œí–‰ (BuildStatus ë³€ê²½)

âœ… ë°°í¬ ì‹œìŠ¤í…œ (agent/src/build/deployer.rs)
   - ëŸ°íƒ€ì„ ì»¨í…Œì´ë„ˆ ìƒì„±
   - Health Check (10íšŒ ì¬ì‹œë„, 5ì´ˆ ê°„ê²©)
   - Blue/Green ìŠ¬ë¡¯ ì „í™˜
   - ì´ì „ ì»¨í…Œì´ë„ˆ ì •ë¦¬

âœ… ë¹Œë“œ í (agent/src/build/worker.rs)
   - í”„ë¡œì íŠ¸ë³„ ìˆœì°¨ ë¹Œë“œ (ë™ì¼ í”„ë¡œì íŠ¸ ë¹Œë“œëŠ” ìˆœì°¨)
   - í”„ë¡œì íŠ¸ ê°„ ë³‘ë ¬ ë¹Œë“œ
   - ë°±ê·¸ë¼ìš´ë“œ ì›Œì»¤ ìŠ¤ë ˆë“œ

âœ… ìºì‹œ ì‹œìŠ¤í…œ
   - íŒ¨í‚¤ì§€ ë§¤ë‹ˆì €ë³„ ìºì‹œ ê²½ë¡œ ë§¤í•‘
   - gradle â†’ /root/.gradle
   - maven â†’ /root/.m2
   - npm â†’ /root/.npm
   - pip â†’ /root/.cache/pip
   - cargo â†’ /usr/local/cargo/registry

âœ… ì¤‘ê°„ ìš°ì„ ìˆœìœ„ ê°œì„ ì‚¬í•­
   - Glob íŒ¨í„´ ì§€ì› (globset í¬ë ˆì´íŠ¸)
   - ìˆ˜ë™ ë¹Œë“œ íŠ¸ë¦¬ê±° API (POST /api/projects/:id/builds)
   - í”„ë¡œì íŠ¸ ì‚­ì œ API (DELETE /api/projects/:id)
   - Docker ì´ë¯¸ì§€ pull ì—ëŸ¬ ê°ì§€ ë° ì „íŒŒ

Phase 3: API ì„œë²„ (ì™„ë£Œ)
----------------------------------
âœ… Webhook í•¸ë“¤ëŸ¬ (agent/src/api/webhook.rs)
   - GitHub Webhook ìˆ˜ì‹ 
   - HMAC-SHA256 ì„œëª… ê²€ì¦
   - Path Filter Glob íŒ¨í„´ ë§¤ì¹­
   - ë¹Œë“œ ìƒì„± ë° í ë“±ë¡

âœ… REST API (agent/src/api/)
   - GET/POST /api/projects - í”„ë¡œì íŠ¸ CRUD
   - GET /api/projects/:id - í”„ë¡œì íŠ¸ ì¡°íšŒ
   - DELETE /api/projects/:id - í”„ë¡œì íŠ¸ ì‚­ì œ (ë¦¬ì†ŒìŠ¤ ì •ë¦¬ í¬í•¨)
   - POST /api/projects/:id/builds - ìˆ˜ë™ ë¹Œë“œ íŠ¸ë¦¬ê±°
   - GET /api/builds - ë¹Œë“œ ëª©ë¡ ì¡°íšŒ (í•„í„°ë§ ì§€ì›)
   - GET /api/builds/:id - ë¹Œë“œ ìƒì„¸ ì¡°íšŒ

âœ… WebSocket ì„œë²„ (agent/src/api/ws.rs)
   - êµ¬ë…/êµ¬ë… í•´ì œ ë©”ì‹œì§€ ì²˜ë¦¬
   - í´ë¼ì´ì–¸íŠ¸ ì—°ê²° ê´€ë¦¬ (WsConnections)

âœ… WebSocket ë¸Œë¡œë“œìºìŠ¤í„° (agent/src/ws_broadcaster.rs)
   - ì´ë²¤íŠ¸ ë²„ìŠ¤ â†’ WebSocket í´ë¼ì´ì–¸íŠ¸
   - ì‹¤ì‹œê°„ ìƒíƒœ ì—…ë°ì´íŠ¸

Phase 4: ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ (ì™„ë£Œ)
----------------------------------
âœ… Path-based ë¼ìš°íŒ… (agent/src/proxy/router.rs)
   - /{project_name}/** â†’ í™œì„± ìŠ¬ë¡¯ ì»¨í…Œì´ë„ˆ
   - HTTP ìš”ì²­ í—¤ë” ì „ë‹¬
   - Hyper ê¸°ë°˜ í”„ë¡ì‹œ
   - Gateway IPë¥¼ í†µí•œ ì»¨í…Œì´ë„ˆ ê°„ í†µì‹ 

Phase 5: Web UI (ì™„ë£Œ)
----------------------------------
âœ… Svelte í”„ë¡ íŠ¸ì—”ë“œ
   - frontend-svelte/ ë””ë ‰í† ë¦¬
   - Vite ë¹Œë“œ ì‹œìŠ¤í…œ
   - svelte-spa-routerë¡œ SPA ë¼ìš°íŒ…

âœ… Dashboard í˜ì´ì§€ (src/routes/Dashboard.svelte)
   - í”„ë¡œì íŠ¸ ëª©ë¡ í‘œì‹œ
   - ìƒíƒœ ë°°ì§€ (Running/Not Deployed)
   - Trigger Build ë²„íŠ¼
   - Delete ë²„íŠ¼
   - View Builds ë§í¬

âœ… Setup í˜ì´ì§€ (src/routes/Setup.svelte)
   - í”„ë¡œì íŠ¸ ìƒì„± í¼
   - ë¹Œë“œ ì„¤ì • (ì´ë¯¸ì§€, ìºì‹œ, ëª…ë ¹ì–´)
   - ëŸ°íƒ€ì„ ì„¤ì • (ì´ë¯¸ì§€, ëª…ë ¹ì–´, health check)
   - í¼ ê²€ì¦

âœ… Build History í˜ì´ì§€ (src/routes/BuildHistory.svelte)
   - í”„ë¡œì íŠ¸ ì •ë³´ í‘œì‹œ
   - ë¹Œë“œ ëª©ë¡ (ë²ˆí˜¸, ìƒíƒœ, commit, ì‹œê°„)
   - ë¹Œë“œ ìƒì„¸ ë³´ê¸°
   - Trigger Build ë²„íŠ¼

âœ… ìŠ¤íƒ€ì¼ë§ (src/app.css)
   - ëª¨ë˜í•œ UI ë””ìì¸
   - ìƒíƒœë³„ ìƒ‰ìƒ êµ¬ë¶„
   - ë°˜ì‘í˜• ë ˆì´ì•„ì›ƒ
   - ë²ˆë“¤ í¬ê¸°: 20.76 kB (gzip)

âœ… Static íŒŒì¼ ì„œë¹™
   - tower-http ServeDirë¡œ /frontend ë””ë ‰í† ë¦¬ ì„œë¹™
   - main.rsì—ì„œ ë¼ìš°íŒ… ì„¤ì •

Phase 6: GitHub í†µí•© (ì™„ë£Œ)
----------------------------------
âœ… GitHub OAuth ì—°ë™
   - PAT í† í° ì €ì¥ ë° ì•”í˜¸í™”
   - ë ˆí¬ì§€í† ë¦¬ ëª©ë¡ ì¡°íšŒ
   - ë¸Œëœì¹˜ ëª©ë¡ ì¡°íšŒ
   - íŒŒì¼ íŠ¸ë¦¬ íƒìƒ‰

âœ… í”„ë¡œì íŠ¸ ìë™ ê°ì§€ (agent/src/github/detector.rs)
   - Node.js í”„ë¡œì íŠ¸ (package.json)
   - Python í”„ë¡œì íŠ¸ (requirements.txt, setup.py)
   - Rust í”„ë¡œì íŠ¸ (Cargo.toml)
   - Go í”„ë¡œì íŠ¸ (go.mod)
   - Java í”„ë¡œì íŠ¸ (pom.xml, build.gradle)
   - Dockerfile ê¸°ë°˜ í”„ë¡œì íŠ¸

âœ… ì›Œí¬í”Œë¡œìš° ìë™ ê°ì§€
   - .github/workflows/*.yml íŒŒì¼ ë¶„ì„
   - ë¹Œë“œ ëª…ë ¹ì–´ ì¶”ì¶œ
   - ëŸ°íƒ€ì„ ì„¤ì • ì¶”ì¶œ

Phase 7: ë„¤íŠ¸ì›Œí¬ í†µì‹  ê°œì„  (ì™„ë£Œ) ğŸ†•
----------------------------------
âœ… Docker ë„¤íŠ¸ì›Œí¬ ì•„í‚¤í…ì²˜ ê°œì„ 
   - Gateway IP ìë™ ê°ì§€ (agent/src/docker/client.rs:60-72)
   - Runtime ì»¨í…Œì´ë„ˆë¥¼ easycicd_easycicd ë„¤íŠ¸ì›Œí¬ì— ì—°ê²°
   - ë©€í‹° ë„¤íŠ¸ì›Œí¬ ì§€ì› (bridge + easycicd_easycicd)

âœ… í—¬ìŠ¤ì²´í¬ í†µì‹  ê°œì„ 
   - localhost â†’ Gateway IP (172.19.0.1) ì‚¬ìš©
   - ë„¤íŠ¸ì›Œí¬ ê²©ë¦¬ ë¬¸ì œ í•´ê²°
   - ì•ˆì •ì ì¸ ì»¨í…Œì´ë„ˆ ê°„ í†µì‹ 

âœ… ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ í†µì‹  ê°œì„ 
   - AppStateì— gateway_ip ì¶”ê°€
   - í”„ë¡ì‹œ ë¼ìš°íŒ…ì—ì„œ Gateway IP ì‚¬ìš©
   - Cloudflare Tunnel ì—°ë™ ì§€ì›

Phase 8: ëª¨ë…¸ë ˆí¬ ì§€ì› (ì™„ë£Œ) ğŸ†•
----------------------------------
âœ… Working Directory ì§€ì›
   - 004_working_directory.sql ë§ˆì´ê·¸ë ˆì´ì…˜ ì¶”ê°€
   - models.rsì— working_directory í•„ë“œ ì¶”ê°€ (Project, CreateProject)
   - path_filterë¡œë¶€í„° working_directory ìë™ ì¶”ì¶œ (detector.rs:50-54)

âœ… ë¹Œë“œ ì»¨í…Œì´ë„ˆ WORKDIR ë™ì  ì„¤ì •
   - docker/client.rsì—ì„œ working_directory ê¸°ë°˜ WORKDIR ì„¤ì •
   - /app (ë£¨íŠ¸) ë˜ëŠ” /app/subdirectory ìë™ ì„ íƒ
   - build/executor.rsì—ì„œ working_directory ì „ë‹¬

âœ… ë°ì´í„° í”Œë¡œìš° ì™„ì„±
   - Frontend: Setup.svelteì—ì„œ working_directory ì „ì†¡
   - Backend API: projects.rsì—ì„œ ìˆ˜ì‹  ë° CreateProjectë¡œ ì „ë‹¬
   - Database: queries.rs INSERT ì¿¼ë¦¬ì— working_directory ì €ì¥
   - Build: executor.rs â†’ docker/client.rs â†’ ë¹Œë“œ ì»¨í…Œì´ë„ˆ WORKDIR

âœ… ë¹Œë“œ ì¶œë ¥ ë³µì‚¬ ê°œì„ 
   - ëª¨ë“  í”„ë¡œì íŠ¸ íƒ€ì…ì— /output ë³µì‚¬ ëª…ë ¹ ì¶”ê°€
   - Node.js: dist/* ë˜ëŠ” build/* â†’ /output/
   - Gradle/Maven: *.jar â†’ /output/app.jar
   - Runtime ëª…ë ¹ì–´: /output/app.jar ì‚¬ìš©

Phase 9: ì„œë¸Œë„ë©”ì¸ ê¸°ë°˜ ë¼ìš°íŒ… (ì§„í–‰ ì¤‘) ğŸ†•
----------------------------------
âœ… í”„ë¡ì‹œ ë¼ìš°í„° ê°œì„ 
   - Host í—¤ë”ì—ì„œ ì„œë¸Œë„ë©”ì¸ ì¶”ì¶œ (proxy/router.rs)
   - ì„œë¸Œë„ë©”ì¸ ë°©ì‹: project1.app.albl.cloud â†’ project1
   - ê²½ë¡œ ê¸°ë°˜ í´ë°±: /project1/... (í•˜ìœ„ í˜¸í™˜ì„±)
   - base_domain ê¸°ë°˜ ë¼ìš°íŒ… ê²°ì •

âœ… AppStateì— base_domain ì¶”ê°€
   - state.rsì— base_domain: Option<String> í•„ë“œ ì¶”ê°€
   - main.rsì—ì„œ DBë¡œë¶€í„° base_domain ë¡œë“œ
   - ë„ë©”ì¸ ê¸°ë°˜ ë¼ìš°íŒ… í™œì„±í™”/ë¹„í™œì„±í™”

âœ… í”„ë¡ íŠ¸ì—”ë“œ URL ìƒì„± ìˆ˜ì •
   - Dashboard.svelteì˜ getProjectUrl() í•¨ìˆ˜
   - ì„œë¸Œë„ë©”ì¸ ë°©ì‹ URL ìƒì„±: https://project1.app.albl.cloud/

Phase 10: ë¸”ë£¨-ê·¸ë¦° ë°°í¬ ê´€ë¦¬ ê°•í™” (ì™„ë£Œ) ğŸ†•
----------------------------------
âœ… ì‹œìŠ¤í…œ ì‹œì‘ ì‹œ ì»¨í…Œì´ë„ˆ ìƒíƒœ ë™ê¸°í™”
   - main.rsì— synchronize_container_states() í•¨ìˆ˜ ì¶”ê°€ (line 163-200)
   - DBì— ì €ì¥ëœ ì»¨í…Œì´ë„ˆ IDê°€ ì‹¤ì œë¡œ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸
   - ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì»¨í…Œì´ë„ˆ IDëŠ” DBì—ì„œ ìë™ ì œê±°
   - ì‹œìŠ¤í…œ ì¬ì‹œì‘ í›„ orphaned ì»¨í…Œì´ë„ˆ ì°¸ì¡° ë°©ì§€

âœ… ë°°í¬ ì „ íƒ€ê²Ÿ ìŠ¬ë¡¯ ì •ë¦¬
   - deployer.rsì— pre-deployment cleanup ë¡œì§ ì¶”ê°€ (line 57-83)
   - ìƒˆ ì»¨í…Œì´ë„ˆ ì‹œì‘ ì „ íƒ€ê²Ÿ ìŠ¬ë¡¯ì˜ ê¸°ì¡´ ì»¨í…Œì´ë„ˆ í™•ì¸
   - ì¡´ì¬í•˜ë©´ ì¤‘ì§€(stop) ë° ì œê±°(remove)
   - DBì—ì„œ ì»¨í…Œì´ë„ˆ ID ì œê±° í›„ ìƒˆ ì»¨í…Œì´ë„ˆ ì‹œì‘
   - ìŠ¬ë¡¯ ìƒíƒœë¥¼ í•­ìƒ ê¹”ë”í•˜ê²Œ ìœ ì§€

âœ… í—¬ìŠ¤ì²´í¬ ë¡œì§ ê°œì„ 
   - HTTP ê¸°ë°˜ â†’ Docker ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸ ë°©ì‹ìœ¼ë¡œ ë³€ê²½
   - Context path ì„¤ì • ë¶ˆí•„ìš” (Spring Boot /api/spring ë“±)
   - 10íšŒ ì¬ì‹œë„, 2ì´ˆ ê°„ê²©
   - ì‹¤ì œ ì»¨í…Œì´ë„ˆ IDë¥¼ ì§ì ‘ ì „ë‹¬ (stale data ë¬¸ì œ í•´ê²°)
   - deployer.rs perform_health_check() í•¨ìˆ˜ ì‹œê·¸ë‹ˆì²˜ ë³€ê²½ (line 252-310)

âœ… í¬íŠ¸ í• ë‹¹ ì „ëµ
   - í•­ìƒ 2ê°œ ë‹¨ìœ„(blue_port, green_port)ë¡œ í• ë‹¹
   - 10002ë¶€í„° ìˆœì°¨ì  í• ë‹¹ (queries.rs:123-169)
   - active_slot ê¸°ë³¸ê°’: 'Blue'
   - ëª¨ë“  container_idëŠ” NULLë¡œ ì‹œì‘

âœ… ë¸”ë£¨-ê·¸ë¦° ê´€ë¦¬ 3ë‹¨ê³„ ë³´í˜¸
   1. í”„ë¡œì íŠ¸ ìƒì„±: active_slot='Blue', container_ids=NULL
   2. ì‹œìŠ¤í…œ ì‹œì‘: ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì»¨í…Œì´ë„ˆ DB ì •ë¦¬
   3. ë°°í¬ ì „: íƒ€ê²Ÿ ìŠ¬ë¡¯ ê¸°ì¡´ ì»¨í…Œì´ë„ˆ ì •ë¦¬

ì£¼ìš” ê¸°ìˆ  ìŠ¤íƒ
----------------------------------
ë°±ì—”ë“œ:
- Rust 1.92
- Axum 0.8 (ì›¹ í”„ë ˆì„ì›Œí¬)
- Tokio (ë¹„ë™ê¸° ëŸ°íƒ€ì„)
- SQLx 0.8 (ë°ì´í„°ë² ì´ìŠ¤)
- Bollard 0.19 (Docker API)
- Hyper 1.0 (ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ)
- tokio-tungstenite (WebSocket)

í”„ë¡ íŠ¸ì—”ë“œ:
- Svelte 4
- Vite (ë¹Œë“œ ë„êµ¬)
- svelte-spa-router (ë¼ìš°íŒ…)
- Vanilla CSS

ì¸í”„ë¼:
- Docker (DOOD: Docker-outside-of-Docker)
- SQLite (ë°ì´í„°ë² ì´ìŠ¤)
- Cloudflare Tunnel (ì™¸ë¶€ ì ‘ê·¼)

ì£¼ìš” ìˆ˜ì •ì‚¬í•­ ë° ë²„ê·¸ í”½ìŠ¤
----------------------------------
1. Gitì„ Dockerfile ëŸ°íƒ€ì„ì— ì¶”ê°€
2. ìºì‹œ ë§ˆìš´íŠ¸ ê²½ë¡œ ìˆ˜ì • (/cache â†’ íŒ¨í‚¤ì§€ ë§¤ë‹ˆì €ë³„ ê²½ë¡œ)
3. finished_at ì—…ë°ì´íŠ¸ (finish_build() ì‚¬ìš©)
4. ì»¨í…Œì´ë„ˆ ì •ë¦¬ ë²„ê·¸ ìˆ˜ì • (old_slot ê°ì§€)
5. Docker ë„¤íŠ¸ì›Œí¬ ëª¨ë“œ ì¶”ê°€ (bridge)
6. í”„ë¡ì‹œ í—¤ë” ì „ë‹¬ êµ¬í˜„
7. Glob íŒ¨í„´ ì§€ì› ì¶”ê°€ (ì‰¼í‘œë¡œ ì—¬ëŸ¬ íŒ¨í„´)
8. í”„ë¡œì íŠ¸ ì‚­ì œ ì‹œ ë¦¬ì†ŒìŠ¤ ì •ë¦¬
9. nginx daemon directive ì¤‘ë³µ ì œê±° ğŸ†•
10. Docker ë„¤íŠ¸ì›Œí¬ Gateway IP ì‚¬ìš© ğŸ†•
11. ë©€í‹° ë„¤íŠ¸ì›Œí¬ ì»¨í…Œì´ë„ˆ ì§€ì› ğŸ†•
12. ëª¨ë…¸ë ˆí¬ working_directory DB ì €ì¥ ëˆ„ë½ ìˆ˜ì • ğŸ†•
13. í—¬ìŠ¤ì²´í¬ stale data ë¬¸ì œ ìˆ˜ì • (ì»¨í…Œì´ë„ˆ ID ì§ì ‘ ì „ë‹¬) ğŸ†•
14. ì‹œìŠ¤í…œ ì‹œì‘ ì‹œ ì»¨í…Œì´ë„ˆ ìƒíƒœ ë™ê¸°í™” ğŸ†•
15. ë°°í¬ ì „ íƒ€ê²Ÿ ìŠ¬ë¡¯ ì •ë¦¬ ë¡œì§ ì¶”ê°€ ğŸ†•

ë””ë ‰í† ë¦¬ êµ¬ì¡°
----------------------------------
easycicd/
â”œâ”€â”€ agent/                      # Rust ë°±ì—”ë“œ
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ api/               # REST API & WebSocket
â”‚   â”‚   â”œâ”€â”€ build/             # ë¹Œë“œ ì‹œìŠ¤í…œ
â”‚   â”‚   â”œâ”€â”€ db/                # ë°ì´í„°ë² ì´ìŠ¤
â”‚   â”‚   â”œâ”€â”€ docker/            # Docker í´ë¼ì´ì–¸íŠ¸
â”‚   â”‚   â”œâ”€â”€ proxy/             # ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ
â”‚   â”‚   â”œâ”€â”€ github/            # GitHub í†µí•©
â”‚   â”‚   â”œâ”€â”€ events.rs          # ì´ë²¤íŠ¸ ë²„ìŠ¤
â”‚   â”‚   â”œâ”€â”€ state.rs           # ê³µìœ  ìƒíƒœ
â”‚   â”‚   â””â”€â”€ main.rs            # ë©”ì¸ ì§„ì…ì 
â”‚   â”œâ”€â”€ migrations/            # DB ë§ˆì´ê·¸ë ˆì´ì…˜
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â””â”€â”€ Cargo.toml
â”‚
â”œâ”€â”€ frontend-svelte/           # Svelte ì†ŒìŠ¤ì½”ë“œ
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ routes/           # í˜ì´ì§€ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”œâ”€â”€ App.svelte        # ë¼ìš°í„°
â”‚   â”‚   â””â”€â”€ app.css           # ìŠ¤íƒ€ì¼
â”‚   â””â”€â”€ vite.config.js
â”‚
â”œâ”€â”€ frontend/                  # ë¹Œë“œ ê²°ê³¼ë¬¼ (ë°°í¬ìš©)
â”‚   â”œâ”€â”€ index.html
â”‚   â””â”€â”€ assets/
â”‚
â”œâ”€â”€ docker-compose.yml         # í”„ë¡œë•ì…˜ Docker Compose
â”œâ”€â”€ deploy.sh                  # ë°°í¬ ìŠ¤í¬ë¦½íŠ¸
â””â”€â”€ ì„¤ê³„ ë¬¸ì„œë“¤


================================================================================
âš ï¸ ë¶€ë¶„ êµ¬í˜„ / ê°œì„  í•„ìš”
================================================================================

1. ì‹¤ì‹œê°„ ë¡œê·¸ ìŠ¤íŠ¸ë¦¬ë°
----------------------------------
í˜„ì¬ ìƒíƒœ:
- ë¡œê·¸ íŒŒì¼ ê²½ë¡œë§Œ í‘œì‹œ
- ì‹¤ì œ ë¡œê·¸ ë‚´ìš© í‘œì‹œ ì•ˆ ë¨

ê°œì„  ë°©ì•ˆ:
- ë¡œê·¸ íŒŒì¼ ì½ê¸° API ì¶”ê°€ (GET /api/builds/:id/logs)
- WebSocketìœ¼ë¡œ ì‹¤ì‹œê°„ ë¡œê·¸ ìŠ¤íŠ¸ë¦¬ë°
- í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ë¡œê·¸ í‘œì‹œ

2. WebSocket ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸
----------------------------------
í˜„ì¬ ìƒíƒœ:
- ë°±ì—”ë“œ WebSocket ì„œë²„ êµ¬í˜„ë¨
- í”„ë¡ íŠ¸ì—”ë“œì—ì„œ WebSocket ì—°ê²° êµ¬í˜„ ì•ˆ ë¨

ê°œì„  ë°©ì•ˆ:
- Svelte ì»´í¬ë„ŒíŠ¸ì—ì„œ WebSocket ì—°ê²°
- ë¹Œë“œ ìƒíƒœ ë³€ê²½ ì‹œ ìë™ UI ì—…ë°ì´íŠ¸
- ì‹¤ì‹œê°„ ì•Œë¦¼ í‘œì‹œ

3. ì—ëŸ¬ ë³µêµ¬ ë° ë¡¤ë°±
----------------------------------
í˜„ì¬ ìƒíƒœ:
- ë°°í¬ ì‹¤íŒ¨ ì‹œ ìƒíƒœë§Œ Failedë¡œ ë³€ê²½
- í—¬ìŠ¤ì²´í¬ ì‹¤íŒ¨ ì‹œ ì»¨í…Œì´ë„ˆ ì‚­ì œ (ë””ë²„ê¹… ëª¨ë“œì—ì„œëŠ” ë¹„í™œì„±í™”)

ê°œì„  ë°©ì•ˆ:
- Health Check ì‹¤íŒ¨ ì‹œ ì´ì „ ìŠ¬ë¡¯ìœ¼ë¡œ ìë™ ë¡¤ë°±
- ë°°í¬ ì‹¤íŒ¨ ì´ë ¥ ì €ì¥
- ì‹¤íŒ¨ ì›ì¸ ìƒì„¸ ë¡œê¹…


================================================================================
âŒ ë¯¸êµ¬í˜„ ì‘ì—… (Phase 8)
================================================================================

1. UI ê°œì„ ì‚¬í•­
----------------------------------
í•„ìš” í•­ëª©:
- Dashboardì—ì„œ í”„ë¡œì íŠ¸ URL í´ë¦­ ì‹œ ì™¸ë¶€ ë§í¬ë¡œ ì´ë™
- ë‚˜ë¨¸ì§€ ì˜ì—­ í´ë¦­ ì‹œ ë¹Œë“œ ìƒì„¸ë¡œ ì´ë™
- ì ‘ê·¼ì„± ê°œì„  (ARIA, í‚¤ë³´ë“œ ì´ë²¤íŠ¸)

2. README ì‘ì„±
----------------------------------
í¬í•¨ ë‚´ìš©:
- í”„ë¡œì íŠ¸ ì†Œê°œ
- ì£¼ìš” ê¸°ëŠ¥
- ì„¤ì¹˜ ë°©ë²•
- ì‚¬ìš© ë°©ë²•
- API ë¬¸ì„œ ë§í¬
- ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨
- ë¼ì´ì„ ìŠ¤

íŒŒì¼: README.md

3. ë°°í¬ ê°€ì´ë“œ
----------------------------------
í¬í•¨ ë‚´ìš©:
- ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬í•­
- ì„¤ì¹˜ ë‹¨ê³„ë³„ ê°€ì´ë“œ
- í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
- GitHub Webhook ì„¤ì • ë°©ë²•
- Cloudflare Tunnel ì„¤ì •
- íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

íŒŒì¼: DEPLOYMENT.md

4. í†µí•© í…ŒìŠ¤íŠ¸
----------------------------------
í•„ìš” í•­ëª©:
- API ì—”ë“œí¬ì¸íŠ¸ í…ŒìŠ¤íŠ¸
- ë¹Œë“œ ì›Œí¬í”Œë¡œìš° E2E í…ŒìŠ¤íŠ¸
- WebSocket ì—°ê²° í…ŒìŠ¤íŠ¸
- ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ í…ŒìŠ¤íŠ¸
- ë„¤íŠ¸ì›Œí¬ í†µì‹  í…ŒìŠ¤íŠ¸

5. CI/CD íŒŒì´í”„ë¼ì¸
----------------------------------
í•„ìš” í•­ëª©:
- GitHub Actions ì„¤ì •
- Docker ì´ë¯¸ì§€ ë¹Œë“œ ìë™í™”
- ë¦´ë¦¬ìŠ¤ ìë™í™”
- ë²„ì „ íƒœê¹…


================================================================================
ìš°ì„ ìˆœìœ„ ì¶”ì²œ
================================================================================

ë†’ìŒ (ì‚¬ìš©ì ê²½í—˜ ê°œì„ ):
1. Dashboard UI ê°œì„  (URL ë§í¬ ë¶„ë¦¬)
2. ì‹¤ì‹œê°„ ë¡œê·¸ ìŠ¤íŠ¸ë¦¬ë° êµ¬í˜„
3. WebSocket ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ êµ¬í˜„

ì¤‘ê°„ (ë¬¸ì„œí™”):
4. README ì‘ì„±
5. ê¸°ë³¸ ë°°í¬ ê°€ì´ë“œ ì‘ì„±
6. API ë¬¸ì„œí™”

ë‚®ìŒ (ì•ˆì •ì„± í–¥ìƒ):
7. ì—ëŸ¬ ë³µêµ¬ ë° ë¡¤ë°± êµ¬í˜„
8. í†µí•© í…ŒìŠ¤íŠ¸ ì‘ì„±
9. CI/CD íŒŒì´í”„ë¼ì¸ ì„¤ì •


================================================================================
ì•Œë ¤ì§„ ì œí•œì‚¬í•­
================================================================================

1. ë‹¨ì¼ ì„œë²„ í™˜ê²½
   - ìˆ˜í‰ í™•ì¥ ë¶ˆê°€ëŠ¥
   - ë‹¨ì¼ ì¥ì• ì  ì¡´ì¬

2. ë¡œê·¸ ì €ì¥ì†Œ
   - ë¡œì»¬ íŒŒì¼ ì‹œìŠ¤í…œì—ë§Œ ì €ì¥
   - ë¡œê·¸ ìˆœí™˜(rotation) ì—†ìŒ

3. ë³´ì•ˆ
   - HTTPSëŠ” Cloudflare Tunnelì—ì„œ ì²˜ë¦¬
   - ì‚¬ìš©ì ì¸ì¦ ì—†ìŒ
   - API í‚¤ ì¸ì¦ ì—†ìŒ

4. ëª¨ë‹ˆí„°ë§
   - ë©”íŠ¸ë¦­ ìˆ˜ì§‘ ì—†ìŒ
   - ì•Œë¦¼ ì‹œìŠ¤í…œ ì—†ìŒ


================================================================================
ë¦¬íŒ©í† ë§: ëª¨ë“ˆí™” ë° ë¡œê¹… ì‹œìŠ¤í…œ êµ¬ì¶• (ì§„í–‰ ì¤‘) ğŸ†•
================================================================================

ëª©í‘œ: ë…ë¦½ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥ / ëª¨ë“ˆ ê°„ ê°„ì„­ ì—†ìŒ / ìƒì„¸ ë¡œê¹…ìœ¼ë¡œ ë¹ ë¥¸ ë¬¸ì œ ì¶”ì 

Phase 1: Trait ì •ì˜ âœ…
----------------------------------
| ì‘ì—… | íŒŒì¼ | ë‚´ìš© |
|------|------|------|
| âœ… Repository Trait | application/ports/repositories.rs | ProjectRepository, BuildRepository, SettingsRepository |
| âœ… Container Trait | application/ports/container_runtime.rs | ContainerRuntime (run_build, run_runtime, stop, remove) |
| âœ… EventBus Trait | application/events/event_bus.rs | EventBus (emit, subscribe) |

Phase 2: ë¡œê¹… ì‹œìŠ¤í…œ êµ¬ì¶• âœ…
----------------------------------
| ì‘ì—… | íŒŒì¼ | ë‚´ìš© |
|------|------|------|
| âœ… BoundaryLogger | infrastructure/logging/boundary_logger.rs | ëª¨ë“  ëª¨ë“ˆ ê²½ê³„ ë¡œê¹… (APIâ†’Service, Serviceâ†’Repo, Serviceâ†’Docker) |
| âœ… TraceContext | infrastructure/logging/trace_context.rs | Trace ID ìƒì„± ë° HTTP í—¤ë” ì „íŒŒ |
| âœ… Timer | infrastructure/logging/boundary_logger.rs | ì„±ëŠ¥ ì¸¡ì •ìš© íƒ€ì´ë¨¸ (elapsed_ms) |

ë¡œê¹… í¬ë§·: [trace_id] [í˜¸ì¶œìâ†’í”¼í˜¸ì¶œì] method [ìƒíƒœ] duration
ì˜ˆ: [abc-123] [APIâ†’Handler] POST /api/projects [ENTRY]
ì˜ˆ: [abc-123] [BuildServiceâ†’Docker] run_build [â†DONE] 22000ms

Phase 3: Infrastructure êµ¬í˜„ âœ…
----------------------------------
| ì‘ì—… | íŒŒì¼ | ë‚´ìš© |
|------|------|------|
| âœ… SqliteProjectRepo | infrastructure/database/sqlite_repo.rs | ProjectRepository êµ¬í˜„ (ê¸°ì¡´ queries.rs ë¡œì§ í™œìš©) |
| âœ… SqliteBuildRepo | infrastructure/database/sqlite_repo.rs | BuildRepository êµ¬í˜„ |
| âœ… SqliteSettingsRepo | infrastructure/database/sqlite_repo.rs | SettingsRepository êµ¬í˜„ |
| â­ï¸ DockerClient ìˆ˜ì • | infrastructure/docker/client.rs | ContainerRuntime trait êµ¬í˜„ (ë‚˜ì¤‘ì—) |
| â­ï¸ MockDockerClient | infrastructure/docker/mock_client.rs | í…ŒìŠ¤íŠ¸ìš© Mock êµ¬í˜„ (ë‚˜ì¤‘ì—) |
| âœ… BroadcastEventBus | application/events/broadcast_event_bus.rs | EventBus êµ¬í˜„ (ê¸°ì¡´ broadcast í™œìš©, í…ŒìŠ¤íŠ¸ í¬í•¨) |

Phase 4: Application Services âœ…
----------------------------------
| ì‘ì—… | íŒŒì¼ | ë‚´ìš© |
|------|------|------|
| âœ… BuildService | application/services/build_service.rs | build/executor.rs ë¡œì§ ì´ë™ + ë¡œê¹… (294ì¤„) |
| âœ… DeploymentService | application/services/deployment_service.rs | build/deployer.rs ë¡œì§ ì´ë™ + ë¡œê¹… (372ì¤„) |
| âœ… ProjectService | application/services/project_service.rs | api/projects.rs ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ë¶„ë¦¬ + ë¡œê¹… (448ì¤„) |

Phase 5: API Layer ë¶„ë¦¬
----------------------------------
| ì‘ì—… | íŒŒì¼ | ë‚´ìš© |
|------|------|------|
| â˜ Projects API | api/routes/projects.rs | Thin handler (ìš”ì²­ íŒŒì‹± â†’ ì„œë¹„ìŠ¤ í˜¸ì¶œ â†’ ì‘ë‹µ) |
| â˜ Builds API | api/routes/builds.rs | Thin handler |
| â˜ Webhook API | api/routes/webhook.rs | Thin handler |
| â˜ Trace ID ë¯¸ë“¤ì›¨ì–´ | api/middleware/trace_id.rs | ëª¨ë“  ìš”ì²­ì— trace_id ì¶”ê°€ |

Phase 6: AppContext ì „í™˜
----------------------------------
| ì‘ì—… | íŒŒì¼ | ë‚´ìš© |
|------|------|------|
| â˜ AppContext | state/app_context.rs | DI ì»¨í…Œì´ë„ˆ (ëª¨ë“  ì„œë¹„ìŠ¤ ì¡°ë¦½) |
| â˜ main.rs ìˆ˜ì • | main.rs | AppState â†’ AppContext |
| â˜ ê¸°ì¡´ ì½”ë“œ ì œê±° | state.rs | ì‚­ì œ |


================================================================================
ë‹¤ìŒ ë‹¨ê³„
================================================================================

ì¦‰ì‹œ ì‹¤í–‰ (Phase 11 ë¦¬íŒ©í† ë§):
1. ë””ë ‰í† ë¦¬ êµ¬ì¡° ìƒì„± ë° Trait ì •ì˜
2. í†µí•© ë¡œê¹… ì‹œìŠ¤í…œ êµ¬ì¶• (BoundaryLogger)
3. Repository êµ¬í˜„
4. Application Services ì‘ì„±
5. API Layer ë¦¬íŒ©í† ë§

ì¶”í›„ ê°œì„  (ê¸°ì¡´ TODO):
6. Dashboard URL ë§í¬ ë¶„ë¦¬ êµ¬í˜„
7. README.md ì‘ì„±
8. ë¡œê·¸ ìŠ¤íŠ¸ë¦¬ë° êµ¬í˜„
9. WebSocket ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸
10. ì—ëŸ¬ ë³µêµ¬ ë©”ì»¤ë‹ˆì¦˜
11. í…ŒìŠ¤íŠ¸ ì‘ì„±
12. ë¬¸ì„œí™” ì™„ì„±


================================================================================
ë¬¸ì˜ ë° ì°¸ê³ 
================================================================================

ì„¤ê³„ ë¬¸ì„œ: ìµœì¢…_ì„¤ê³„_ë¬¸ì„œ.txt
API ëª…ì„¸: API_í†µì‹ _ëª…ì„¸ì„œ.txt
ì˜¤ë‹µë…¸íŠ¸: ì˜¤ë‹µë…¸íŠ¸.txt

ìµœì‹  Commit: (2026-01-08)
Docker Hub: choho97/lightweight-ci:latest (sha256:319e581d0b94...)
